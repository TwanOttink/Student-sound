<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- Load favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="resources/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="resources/images/favicon-16x16.png">
    <link rel="manifest" href="resources/images/site.webmanifest">
    <link rel="mask-icon" href="resources/images/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    <!-- End load favicon -->

    <link rel="stylesheet" href="./resources/css/main.css">

    <!-- Load fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <!-- End load fonts -->

<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">-->

<!--    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>-->

    <title>Student Sound Dashboard</title>
</head>
<body>
    <header class="header">
        <a href="//windesheim.nl/" target="_blank" class="logo">
            <img src="./resources/images/Windesheim_logo.png" alt="Windesheim logo">
        </a>
    </header>
    <main class="main">
        <div class="container">

            <div class="row">
                <div class="intro">
                    <h1 class="title">Student sound dashboard</h1>
                    <p class="text">This webpage is made for educational purposes and is build by Windesheim students. Do not use this page as a viable source of information.</p>
                </div>
            </div>

            <div class="row">
                <button id="refreshData" class="button">Refresh data</button>
                <h2 class="subtitle">Connected classrooms:</h2>
                <div class="devices-wrapper">

                    <div class="device-item">
                        <div class="device-button subtitle">
                            <h4 class="device-title">Location: MT4.02</h4>
                            <div class="device-columns">Last measurement: <span>24DB</span></div>
                        </div>
                        <div class="device-collapse collapse ">
                            <div class="device-body text">
                                <strong>This is the first item's device body.</strong>
                            </div>
                        </div>
                    </div>

                    <div class="device-item">
                        <div class="device-button subtitle">
                            <h4 class="device-title">Location: MT4.02</h4>
                            <div class="device-columns">Last measurement: <span>24DB</span></div>
                        </div>
                        <div class="device-collapse">
                            <div class="device-body text">
                                <strong>This is the first item's device body.</strong> It is n by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the ing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the .device-body, though the transition does limit overflow.
                            </div>
                        </div>
                    </div>

                    <div class="device-item">
                        <div class="device-button subtitle">
                            <h4 class="device-title">Location: MT4.02</h4>
                            <div class="device-columns">Last measurement: <span>24DB</span></div>
                        </div>
                        <div class="device-collapse">
                            <div class="device-body text">
                                <strong>This is the first item's device body.</strong> It is n by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the ing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the .device-body, though the transition does limit overflow.
                            </div>
                        </div>
                    </div>

                    <div class="device-item">
                        <div class="device-button subtitle">
                            <h4 class="device-title">Location: MT4.02</h4>
                            <div class="device-columns">Last measurement: <span class="red">24DB</span></div>
                        </div>
                        <div class="device-collapse">
                            <div class="device-body text">
                                <strong>This is the first item's device body.</strong> It is n by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the ing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the .device-body, though the transition does limit overflow.
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div class="row history_data">
                <h2 class="subtitle">Latest 10 measurements:</h2>

                <table class="history_table">
                    <tr>
                        <th>Location</th>
                        <th>Timestamp</th>
                        <th>Measurement</th>
                    </tr>
                    <tr>
                        <td>T4.16</td>
                        <td>13-09-22 13:28</td>
                        <td>30dB</td>
                    </tr>
                    <tr>
                        <td>T4.16</td>
                        <td>13-09-22 13:28</td>
                        <td>30dB</td>
                    </tr>
                    <tr>
                        <td>T4.16</td>
                        <td>13-09-22 13:28</td>
                        <td>30dB</td>
                    </tr>
                </table>
            </div>
        </div>
    </main>
    <footer class="footer">
        <div class="footer-wrapper">
            <div class="copyright text">Â© Hogeschool Windesheim</div>
        </div>

    </footer>
    <script src="resources/js/devices.js"></script>
    <script src="resources/js/accordeon.js"></script>

    <script>

        // refresh data
        document.getElementById('refreshData').addEventListener('click', function() {
            fetchTData();
        });
    </script>

    <script>
        // global
        var points = [];

        function fetchTData() {
            // fetchpoint for request
            var xmlhttp = new XMLHttpRequest();
            var url = "http://localhost/throwdata.py";

            // empty data points array
            points = [];

            // request status
            xmlhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    var measurements = JSON.parse(this.responseText);
                    for (i = 0; i < measurements.length; i++) {
                        points.push({
                            x:moment.unix(measurements[i].unixtime),
                            y:measurements[i].waarde,
                        });
                    }
                    console.log("test");
                    console.log(points);
                    // we have data: draw
                    drawChart();
                }
            };
            xmlhttp.open("GET", url, true);
            xmlhttp.send();
        }

        function drawChart() {
            // // chart object requires context, data and options
            // var ctx = document.getElementById("tempChart").getContext('2d');
            //
            // var data = {
            //     datasets: [{
            //         label: "Temperatuur",
            //         borderColor: "rgba(0,220,220,0.5)",
            //         backgroundColor: "rgba(0,220,220,0.2)",
            //         pointBorderColor: "rgba(0,220,220,1)",
            //         data: points,
            //     },
            //     ],
            // };
            // var options = {
            //     title: { display: true, text: 'Weerstation' },
            //     scales: {
            //         xAxes: [{
            //             display: true,
            //             type: 'time',
            //             distribution: 'linear',
            //             ticks: { source: 'auto' },
            //             bounds: 'data',
            //             time: { unit: 'minute',
            //                 stepSize: 1,
            //                 displayFormats: { minute: 'H:mm:ss' },
            //             },
            //             scaleLabel: {
            //                 display: true,
            //                 labelString: 'Tijd',
            //             },
            //         }],
            //         yAxes: [{
            //             display: true,
            //             scaleLabel: {
            //                 display: true,
            //                 labelString: 'C',
            //             },
            //             ticks: {
            //                 suggestedMin: 0.0,
            //                 suggestedMax: 100.0,
            //             },
            //         }],
            //     },
            //     elements: {
            //         line: {
            //             tension: 0,
            //         }
            //     },
            // }
            //
            // // create chart with these parameters
            // window.tempChart = new Chart(ctx, {
            //     type: 'line',
            //     data : data,
            //     options: options
            // });
        }

        // create chart with fetched temperature data
        window.onload = function() {
            fetchTData();
        }

    </script>

</body>
</html>